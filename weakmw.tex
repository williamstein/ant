
\chapter{The Weak Mordell-Weil Theorem}\label{ch:weakmw}
\section{Kummer Theory of Number Fields}\label{sec:kummernf}
Suppose $K$ is a number field and fix a positive integer~$n$.
Consider the
exact sequence
$$
  1 \to \mu_n \to \Kbar^* \xrightarrow{n} \Kbar^* \to 1.
$$
The long exact sequence is
$$
 1 \to \mu_n(K) \to K^* \xrightarrow{n} K^* \to \H^1(K,\mu_n) \to \H^1(K,\Kbar^*) =0,
$$
where $\H^1(K,\Kbar^*)=0$ by Theorem~\ref{thm:h90}.

Assume now that the group $\mu_n$ of $n$th roots of unity is contained
in~$K$.  Using Galois cohomology we obtain a relatively simple
classification of all abelian extensions of~$K$ with Galois group
cyclic of order dividing~$n$.  Moreover, since the action of
$\Gal(\Kbar/K)$ on $\mu_n$ is trivial, by our hypothesis that
$\mu_n\subset K$, we see that
$$
  \H^1(K,\mu_n) = \Hom(\Gal(\Kbar/K),\mu_n).
$$
Thus we obtain an exact sequence
$$
 1 \to \mu_n \to K^* \xrightarrow{n} K^* \to \Hom(\Gal(\Kbar/K),\mu_n) \to 1,
$$
or equivalently, an isomorphism
$$
     K^*/(K^*)^n \isom \Hom(\Gal(\Kbar/K),\mu_n),
$$
By Galois theory, homomorphisms $\Gal(\Kbar/K)\to \mu_n$ (up to
automorphisms of $\mu_n$) correspond to cyclic abelian extensions
of~$K$ with Galois group a subgroup of the cyclic group $\mu_n$ of
order~$n$.  Unwinding the definitions, what this says is that every
cyclic abelian extension of $K$ of degree dividing~$n$ is of the form
$K(a^{1/n})$ for some element $a\in K$.  

One can prove via calculations with discriminants, etc. that
$K(a^{1/n})$ is unramified outside $n$ and and the primes that divide
$\Norm(a)$.  Moreover, and this is a much bigger result, one can
combine this with facts about class groups and unit groups to prove
the following theorem:
\begin{theorem}\label{thm:maxunramfin}
  Suppose $K$ is a number field with $\mu_n\subset K$, where $n$ is a
  positive integer.  Then the maximal abelian exponent~$n$ extension $L$
  of~$K$ unramified outside a finite set~$S$ of primes is of finite
  degree.
\end{theorem}
\begin{proof}[Sketch of Proof]
We may enlarge~$S$, because if an extension is unramified outside
a set larger than~$S$, then it is unramified outside~$S$.

We first argue that we can enlarge~$S$ so that the ring 
$$
 \O_{K,S} = \{a \in K^* :  \ord_\p(a\O_K) \geq 0 \text{ all } \p\not\in S\}
    \union\{0\}
$$
is a principal ideal domain.  
Note that for any~$S$, the ring $\O_{K,S}$ is a Dedekind domain.
Also, the condition $ \ord_\p(a\O_K) \geq 0$
means that in the prime ideal factorization of the fractional ideal
$a\O_K$, we have that~$\p$ occurs to a nonnegative power.  Thus we are
allowing denominators at the primes in~$S$.  Since the class group of
$\O_K$ is finite, there are primes $\p_1,\ldots, \p_r$ that generate
the class group as a group (for example, take all primes with norm up to
the Minkowski bound).  Enlarge~$S$ to contain the primes $\p_i$.
Note that the ideal $\p_i\O_{K,S}$ is the unit ideal (we have 
$\p_i^m=(\alpha)$ for some $m\geq 1$;  then $1/\alpha \in \O_{K,S}$,
so $(\p_i\O_{K,S})^m$ is the unit ideal, hence $\p_i \O_{K,S}$
is the unit ideal by unique factorization in the Dedekind
domain $\O_{K,S}$.)
Then $\O_{K,S}$ is a principal ideal domain, since every ideal
of $\O_{K,S}$ is equivalent modulo a principal ideal 
to a product of ideals $\p_i\O_{K,S}$.   Note that we have used
that {\em the class group of $\O_K$ is finite}.

Next enlarge $S$ so that all primes over $n\O_K$ are in~$S$.
Note that $\O_{K,S}$ is still a PID.  Let
$$
 K(S,n) = \{a \in K^*/(K^*)^n : n \mid \ord_\p(a) \text{ all } \p\not\in S\}.
$$
Then a refinement of the arguments at the beginning of
this section show that $L$ is generated by all $n$th roots
of the elements of $K(S,n)$.  It thus sufficies to prove
that $K(S,n)$ is finite.

There is a natural map 
$$
\phi: \O_{K,S}^* \to K(S,n).
$$ 
Suppose $a\in K^*$ is a representative of an element in $K(S,n)$.
The ideal $a \O_{K,S}$ has factorization which is a product of $n$th
powers, so it is an $n$th power of an ideal. Since $\O_{K,S}$ is a PID,
there is $b\in \O_{K,S}$ and $u\in \O_{K,S}^*$ such that
$$
   a = b^n \cdot u.
$$
Thus $u\in \O_{K,S}^*$ maps to $[a] \in K(S,n)$.  Thus $\phi$
is surjective.

Recall that we proved {\em Dirichlet's unit theorem} (see
Theorem~\ref{thm:units}), which asserts that the group $\O_K^*$ is a
finitely generated abelian group of rank $r+s-1$.  More generally, we
now show that $\O_{K,S}^*$ is a finitely generated abelian group of
rank $r+s+\#S -1$.  Once we have shown this, then since $K(S,n)$ is torsion
group that is a quotient of a finitely generated group, we will conclude
that $K(S,n)$ is finite, 
which will prove the theorem.\index{$S$-unit theorem}\index{Dirichlet!$S$-unit theorem}

Thus it remains to prove that $\O_{K,S}^*$ has rank $r+s-1 + \#S$.
Let 
$\p_1,\ldots, \p_n$ be the primes in~$S$.
Define a map $\phi: \O_{K,S}^* \to \Z^n$ by 
$$
  \phi(u) = (\ord_{\p_1}(u), \ldots, \ord_{\p_n}(u)).
$$
First we show that $\Ker(\phi) = \O_K^*$.  We have that
$u\in \Ker(\phi)$ if and only if $u \in \O_{K,S}^*$
and $\ord_{\p_i}(u) = 0$ for all $i$; but the latter condition
implies that $u$ is a unit at each prime in $S$, so $u\in \O_K^*$.
Thus we have an exact sequence
$$
  1 \to \O_K^* \to \O_{K,S}^* \xrightarrow{\phi} \Z^n.
$$
Next we show that the image of $\phi$ has finite index
in $\Z^n$.  Let $h$ be the class number of $\O_K$.
For each $i$ there exists $\alpha_i \in \O_K$
such that $\p_i^h = (\alpha_i)$.  But $\alpha_i \in \O_{K,S}^*$
since $\ord_{\p}(\alpha_i) = 0$ for all $\p\not\in S$ (by unique
factorization).  Then 
$$
  \phi(\alpha_i) = (0,\ldots, 0, h, 0,\ldots, 0).
$$
It follows that $(h\Z)^n \subset \Im(\phi)$, so 
the image of $\phi$ has finite index in $\Z^n$.  It follows
that $\O_{K,S}^*$ has rank equal to $r+s-1+\#S$.
\end{proof}

%\begin{remark}
%See Dannielle Li's excellent senior thesis for more details about this
%argument and the Mordell-Weil theorem.   Download it from\\
%{\tt http://modular.fas.harvard.edu/projects/}.
%\end{remark}

\section{Proof of the Weak Mordell-Weil Theorem}
Suppose $E$ is an elliptic curve over a number field~$K$, and 
fix a positive integer~$n$.
Just as with number fields, we have an exact sequence 
$$
  0 \to E[n] \to E \xra{n} E \to 0.
$$
Then we have an exact sequence
$$
  0 \to E[n](K) \to E(K) \xra{n} E(K) \to \H^1(K,E[n]) \to \H^1(K,E)[n] \to 0.
$$
From this we obtain a short exact sequence
\begin{equation}\label{eqn:ke1}
  0 \to E(K)/n E(K) \to \H^1(K,E[n]) \to \H^1(K,E)[n] \to 0.
\end{equation}

Now assume, in analogy with Section~\ref{sec:kummernf}, that
$E[n]\subset E(K)$, i.e., all $n$-torsion points are defined over~$K$.
Then 
$$\H^1(K,E[n]) = \Hom(\Gal(\Kbar/K),(\Z/n\Z)^2),$$
and the sequence (\ref{eqn:ke1})
induces an inclusion
\begin{equation}\label{eqn:injmw}
  E(K)/n E(K) \hookrightarrow \Hom(\Gal(\Kbar/K),(\Z/n\Z)^2).
\end{equation}
Explicitly, this homomorphism sends a point $P$ to the homomorphism
defined as follows: Choose $Q \in E(\Kbar)$ such that $nQ = P$; then
send each $\sigma \in \Gal(\Kbar/K)$ to $\sigma(Q)-Q\in E[n]\isom
(\Z/n\Z)^2$.  Given a point $P\in E(K)$, we obtain a homomorphism
$\vphi : \Gal(\Kbar/K) \to (\Z/n\Z)^2$, whose kernel defines an
abelian extension~$L$ of $K$ that has exponent~$n$. 
The amazing fact is that $L$ can be ramified at most at the primes
of bad reduction for $E$ and the primes that divide~$n$.  
Thus we can apply theorem~\ref{thm:maxunramfin} to see that there are
only finitely many such~$L$.

\begin{theorem}\label{thm:mwunram}
  If $P\in E(K)$ is a point, then the field~$L$ obtained by adjoining to $K$
  all coordinates of all choices of $Q=\frac{1}{n}P$ is unramified
  outside $n$ and the primes of bad reduction for~$E$.
\end{theorem}
\begin{proof}[Sketch of Proof]
  First one proves that if $\p \nmid n$ is a prime of good reduction
  for~$E$, then the natural reduction map $\pi: E(K)[n] \to
  \tilde{E}(\O_K/\p)$ is injective.  The argument that~$\pi$ is
  injective uses ``formal groups'', whose development is outside the
  scope of this course.  Next, as above, $\sigma(Q)-Q \in E(K)[n]$ for
  all $\sigma \in \Gal(\Kbar/K)$.  Let $I_\p\subset \Gal(L/K)$ be the
  inertia group at $\p$.  Then by definition of interia group, $I_\p$
  acts trivially on $\tilde{E}(\O_K/\p)$.  Thus for each $\sigma \in
  I_\p$ we have
$$
  \pi(\sigma(Q) - Q) = \sigma(\pi(Q)) - \pi(Q) = \pi(Q) - \pi(Q) = 0.
$$
Since $\pi$ is injective, it follows that $\sigma(Q) = Q$ for $\sigma\in I_\p$,
i.e., that $Q$ is fixed under all $I_\p$.  This means that the subfield
of~$L$ generated by the coordinates of $Q$ is unramified at $\p$.
Repeating this argument with all choices of~$Q$ implies that $L$
is unramified at~$\p$.
\end{proof}


\begin{theorem}[Weak Mordell-Weil]
Let $E$ be an elliptic curve over a number field~$K$, and
let $n$ be any positive integer.  Then 
$E(K)/nE(K)$ is finitely generated.
\end{theorem}
\begin{proof}
  First suppose all elements of $E[n]$ have coordinates in~$K$.  Then
  the homomorphism (\ref{eqn:injmw}) provides an injection of $E(K)/n
  E(K)$ into $$\Hom(\Gal(\Kbar/K), (\Z/n\Z)^2).$$ By
  Theorem~\ref{thm:mwunram}, the image consists of homomorphisms whose
  kernels cut out an abelian extension of~$K$ unramified outside $n$
  and primes of bad reduction for~$E$.  Since this is a finite set of
  primes, Theorem~\ref{thm:maxunramfin} implies that the homomorphisms
  all factor through a finite quotient $\Gal(L/K)$ of $\Gal(\Qbar/K)$.
  Thus there can be only finitely many such homomorphisms, so the
  image of $E(K)/nE(K)$ is finite.  Thus $E(K)/nE(K)$ itself is
  finite, which proves the theorem in this case.

Next suppose~$E$ is an elliptic curve over a number field, but do {\em
  not} make the hypothesis that the elements of $E[n]$ have
coordinates in~$K$.  Since the group $E[n](\C)$ is finite and its
elements are defined over~$\Qbar$, the extension~$L$ of~$K$ got by
adjoining to~$K$ all coordinates of elements of $E[n](\C)$ is a finite
extension.  It is also Galois, as we saw when constructing Galois
representations attached to elliptic curves.  By Proposition~\ref{prop:infres},
we have an exact sequence
$$
   0 \to \H^1(L/K, E[n](L))\to   \H^1(K,E[n])\to \H^1(L,E[n]).
$$
The kernel of the restriction map 
$\H^1(K,E[n])\to \H^1(L,E[n])$ is finite, since it is
isomorphic to the finite group cohomology group 
$\H^1(L/K, E[n](L))$.  By the argument of the previous
paragraph, the image of $E(K)/nE(K)$ in $\H^1(L,E[n])$
under
$$
  E(K)/n E(K) \hra \H^1(K,E[n]) \xra{\res} \H^1(L,E[n])
$$
is finite, since it is contained in the image of $E(L)/n E(L)$.
Thus $E(K)/n E(K)$ is finite, since we just proved
the kernel of $\res$ is finite.
\end{proof}



%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "ant"
%%% End: 
