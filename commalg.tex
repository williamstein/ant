\chapter{Basic Commutative Algebra}

The commutative algebra in this chapter provides a
foundation for understanding the more refined number-theoretic
structures associated to number fields.

First we prove the structure theorem for finitely generated abelian
groups.  Then we establish the standard properties of Noetherian rings
and modules, including a proof of the Hilbert basis theorem.  We also
observe that finitely generated abelian groups are Noetherian
$\Z$-modules.  After establishing
properties of Noetherian rings, we consider rings of algebraic
integers and discuss some of their properties.

\section{Finitely Generated Abelian Groups}\label{sec:fg}
Finitely generated abelian groups arise all over algebraic number
theory.  For example, they will appear in this book as class groups,
unit groups, and the underlying additive groups of rings of integers,
and as Mordell-Weil groups of elliptic curves.

In this section, we prove the structure theorem for finitely generated
abelian groups, since it will be crucial for much of what we will do
later. \i{abelian groups!structure theorem} \i{structure theorem}

Let $\Z=\{0,\pm 1, \pm 2, \ldots\}$ denote the ring of (rational)
integers, and for each positive integer~$n$, let $\Z/n\Z$ denote the
ring of integers modulo~$n$, which is a cyclic abelian group of
order~$n$ under addition.

\begin{definition}[Finitely Generated]
	A group $G$ is \defn{finitely generated} if there exists
	$g_1,\ldots, g_n \in G$ such that every element of $G$ can be
	expressed as a finite product (or sum, if we write $G$ additively)
	of positive or negative powers of the $g_i$.
\end{definition}
For example, the group $\Z$ is finitely generated, since it is generated
by~$1$.

\begin{theorem}[Structure Theorem for Finitely Generated Abelian Groups]
	\label{thm:struc}\ithm{structure of abelian groups}
	Let $G$ be a finitely generated abelian group. Then there is an isomorphism
	$$
		G \ncisom (\Z/n_1\Z) \oplus (\Z/n_2\Z) \oplus
		\cdots \oplus (\Z/n_s\Z) \oplus \Z^{r},
	$$
	where $r, s\geq 0$, $n_i>1$ for all $i$, and $n_1\mid{}n_2\mid{}\cdots \mid{}n_s$.
	Furthermore, the $n_i$ and~$r$ are uniquely determined by~$G$.
\end{theorem}

\begin{exercise}
	Quick! Guess how many abelian groups there are of order less than $12$.
	Use Theorem~\ref{thm:struc} to classify all abelian groups of order
	less than $12$. How many do you think there are? How many are there?
\end{exercise}

We will prove the theorem as follows.  We first remark that any
subgroup of a finitely generated free abelian group is finitely
generated.  Then we see how to represent finitely generated abelian groups
as quotients of finite rank free abelian groups, and how to
reinterpret such a presentation in terms of matrices over the
integers.  Next we describe how to use row and column operations over
the integers to show that every matrix over the integers is equivalent
to one in a canonical diagonal form, called the Smith normal form.  We
obtain a proof of the theorem by reinterpreting the \ii{Smith normal form} in
terms of groups.  Finally, we observe that
the representation in the theorem is necessarily unique.

\begin{proposition}\label{prop:subfin}\iprop{subgroup of free group}
	If $H$ is a subgroup of a finitely generated abelian group $G$,
	then $H$ is finitely generated.
\end{proposition}
The key reason that this is true is that~$G$ is a finitely generated
module over the principal ideal domain $\Z$.  We defer the
proof of Proposition~\ref{prop:subfin} to Section~\ref{sec:noetherian},
where we will give a complete proof of a beautiful generalization
in the context of Noetherian rings (the Hilbert basis theorem).

\begin{corollary}
	\label{cor:presentation}\icor{group as quotient of free groups}
	Suppose $G$ is a finitely generated abelian group. Then there are
	finitely generated free abelian groups $F_1$ and $F_2$ and there is
	a homomorphism $\psi:F_2 \to F_1$ such that $G \ncisom F_1/\psi(F_2)$.
\end{corollary}
\begin{proof}
	Let $x_1,\ldots, x_m$ be generators for $G$. Let $F_1=\Z^m$ and let
	$\vphi:F_1\to G$ be the homomorphism that sends the $i$th generator
	$(0,0,\ldots,1,\ldots,0)$ of $\Z^m$ to $x_i$. Then $\vphi$ is
	surjective, and by Proposition~\ref{prop:subfin} the
	kernel $\ker(\vphi)$ of $\vphi$ is a finitely generated abelian
	group. Suppose there are $n$ generators for $\ker(\vphi)$, let
	$F_2 = \Z^n$ and fix a surjective homomorphism $\psi:F_2
	\to \ker(\vphi)$. Then $F_1 / \psi(F_2)$ is isomorphic to $G$.
\end{proof}

An \defn{sequence} of homomorphisms of abelian groups
$$
	H \xra{f} G \xra{g} K
$$
is exact if $\im(f) = \ker(g)$.
For longer sequences, exactness means every three consecutive
terms with two arrows are exact.
Given a finitely generated abelian group $G$,
Corollary~\ref{cor:presentation} provides an exact sequence
$$
	F_2 \xra{\psi} F_1 \to G \to 0.
$$

Suppose $G$ is a nonzero finitely generated abelian group.  By the
corollary, there are free abelian groups $F_1$ and $F_2$ and there is a
homomorphism $\psi:F_2 \to F_1$ such that $G\ncisom F_1/\psi(F_2)$.
Upon choosing a basis for $F_1$ and $F_2$, we obtain isomorphisms
$F_1\ncisom \Z^n$ and $F_2\ncisom \Z^m$ for integers $n$ and $m$.
Just as in linear algebra, we view $\psi:F_2\to F_1$ as being given
by left multiplication by the $n\times m$ matrix $A$ whose columns
are the images of the generators of $F_2$ in $\Z^n$.  We visualize
this as follows:
$$
	\Z^m \xra{A} \Z^n \to G \to 0
$$

The \defn{cokernel} of the homomorphism defined by $A$ is the quotient
of $\Z^n$ by the image of $A$ (i.e., the $\Z$-span of the columns of $A$),
and this cokernel is isomorphic to $G$.

The following proposition implies that we may choose a bases for $F_1$
and $F_2$ such that the matrix of $A$ only has nonzero entries along
the diagonal, so that the structure of the cokernel of $A$ is
trivial to understand.

\begin{proposition}[Smith normal form]
	\label{prop:smith}\iprop{Smith normal form}
	Suppose~$A$ is an $n\times m$ integer matrix.  Then there exist
	invertible integer matrices $P$ and $Q$ such that $A'=PAQ$ only
	has nonzero entries along the diagonal, and these entries are
	$n_1, n_2,\ldots, n_s,0,\ldots,0$, where
	$s\geq 0$, $n_i\geq 1$ for all $i$, and $n_1\mid n_2 \mid{} \cdots \mid{} n_s$.
\end{proposition}

\begin{remark}
	Note that the matrices $P$ and $Q$ are invertible as integer
	matrices, so $\det(P)$ and $\det(Q)$ are $\pm 1$. In particular
	$\det A' = \pm\det A$ if $A$ is square.
\end{remark}

\begin{definition}
	The matrix $A'$ in Proposition~\ref{prop:smith}
	is called the \defn{Smith normal form} of $A$.
\end{definition}

We will see in the proof of Theorem~\ref{thm:struc} that
$A'$ is uniquely determined by $A$.
An example of a matrix in Smith normal form is
$$
	A=\left(\begin{matrix}
		2&0&0&0\\
		0&6&0&0\\
		0&0&0&0
	\end{matrix}\right).
$$

\begin{proof}[Proof of Proposition~\ref{prop:smith}]
The matrix $P$ will be a product of matrices that define elementary
row operations and $Q$ will be a product corresponding to elementary
column operations.  The elementary row and column operations over
$\Z$ are as follows:
\begin{description}
	\item[Add multiple:]
		Add an integer multiple of one row to another
		(or a multiple of one column to another).
	\item[Swap:]
		Interchange two rows or two columns.
	\item[Rescale:]
		Multiply a row by $-1$.
\end{description}
Each of these operations is given by left or right multiplying by an
invertible matrix~$E$ with integer entries, where~$E$ is the result of
applying the given operation to the identity matrix, and~$E$ is
invertible because each operation can be reversed using another row or
column operation over the integers.

To see that the proposition must be true, assume $A\neq 0$ and perform
the following steps (compare \cite[pg.~459]{artin:algebra}):
\begin{enumerate}
	\item By permuting rows and columns, move a nonzero entry of $A$ with
	smallest absolute value to the upper left corner of $A$.  Now
	``attempt'' (as explained in detail below) to make all other entries
	in the first row and column $0$ by adding multiples of the top row
	or first column to other rows or columns, as follows:
	\begin{quote}
		Suppose $a_{i1}$ is a nonzero entry in the first column, with
		$i>1$.  Using the division algorithm, write
		$a_{i1} = a_{11}q + r$, with $0\leq r < a_{11}$. Now add $-q$
		times the first row to the $i$th row. If $r>0$, then go to step~1
		(so that an entry with absolute value at most $r$ is the upper
		left corner).
	\end{quote}
	If at any point this operation produces a nonzero entry in the
	matrix with absolute value smaller than $|a_{11}|$, start the
	process over by permuting rows and columns to move that entry to the
	upper left corner of $A$.  Since the integers $|a_{11}|$ are a
	decreasing sequence of positive integers, we will not have to move
	an entry to the upper left corner infinitely often, so when this
	step is done the upper left entry of the matrix is nonzero, and all other         entries in the first row and column are $0$.
	
	\item We may now assume that $a_{11}$ is the only nonzero entry in the
	first row and column.  If some entry $a_{ij}$ of $A$ is not divisible
	by $a_{11}$, add the column of $A$ containing $a_{ij}$ to the first
	column, thus producing an entry in the first column that is nonzero.
	When we perform step~1, the remainder $r$ will be greater than $0$.
	Permuting rows and columns results in a smaller $|a_{11}|$.  Since
	$|a_{11}|$ can only shrink finitely many times, eventually we will get
	to a point where every $a_{ij}$ is divisible by $a_{11}$.  If $a_{11}$
	is negative, multiply the first row by $-1$.
\end{enumerate}
After performing the above operations, the first row and column
of $A$ are zero except for $a_{11}$ which is positive and divides
all other entries of $A$.  We repeat the above steps for the
matrix $B$ obtained from $A$ by deleting the first row and column.
The upper left entry of the resulting matrix will be divisible by
$a_{11}$, since every entry of $B$ is.  Repeating the argument
inductively proves the proposition.
\end{proof}

\begin{example}
The matrix $\mtwo{-2}{2}{-3}{4}$ has Smith normal form
$\mtwo{1}{0}{0}{2}$,
and the matrix
$\mthree{1}{4}{9}{16}{25}{36}{49}{64}{81}$
has Smith normal form
$\mthree{1}{0}{0}{0}{3}{0}{0}{0}{72}.$
As a double check, note that the determinants of a matrix and its
Smith normal form match, up to sign. This is because
$$\det(PAQ) = \det(P)\det(A)\det(Q) = \pm \det(A).$$

We compute each of the above Smith forms using \sage,
along with the corresponding transformation matrices.
To do this we use the \sage{} command {\tt matrix},
which takes as input the base ring, the number
of rows, and the entries. The output of {\tt matrix}
is a matrix object which has the method {\tt smith\_form}.

First the $2\times 2$ matrix.
\begin{sagecode}
\begin{sagecell}
A = matrix(ZZ, 2, [-2,2, -3,4])
S, P, Q = A.smith_form(); S
\end{sagecell}
\begin{sageout}
[1 0]
[0 2]
\end{sageout}
\begin{sagecell}
P*A*Q
\end{sagecell}
\begin{sageout}
[1 0]
[0 2]
\end{sageout}
\begin{sagecell}
P
\end{sagecell}
\begin{sageout}
[0 1]
[1 0]
\end{sageout}
\begin{sagecell}
Q
\end{sagecell}
\begin{sageout}
[1 -4]
[1 -3]
\end{sageout}
\end{sagecode}
Next the $3\times3$ matrix.
\begin{sagecode}
\begin{sagecell}
A = matrix(ZZ, 3, [1,4,9, 16,25,36, 49,64,81])
S, P, Q = A.smith_form(); S
\end{sagecell}
\begin{sageout}
[ 1  0  0]
[ 0  3  0]
[ 0  0 72]
\end{sageout}
\begin{sagecell}
P*A*Q
\end{sagecell}
\begin{sageout}
[ 1  0  0]
[ 0  3  0]
[ 0  0 72]
\end{sageout}
\begin{sagecell}
P
\end{sagecell}
\begin{sageout}
[  0   0   1]
[  0   1  -1]
[  1 -20 -17]
\end{sageout}
\begin{sagecell}
Q
\end{sagecell}
\begin{sageout}
[  47   74   93]
[ -79 -125 -156]
[  34   54   67]
\end{sageout}
\end{sagecode}

For one more example, we compute the Smith form of a
$3\times 3$ matrix of rank $2$:
\begin{sagecode}
\begin{sagecell}
m = matrix(ZZ, 3, [2..10]); m
\end{sagecell}
\begin{sageout}
[ 2  3  4]
[ 5  6  7]
[ 8  9 10]
\end{sageout}
\begin{sagecell}
m.smith_form()[0]
\end{sagecell}
\begin{sageout}
[1 0 0]
[0 3 0]
[0 0 0]
\end{sageout}
\end{sagecode}
\end{example}


\begin{proof}[Proof of Theorem~\ref{thm:struc}]
	Suppose $G$ is a finitely generated abelian group, which we may assume
	is nonzero.  As in the paragraph before Proposition~\ref{prop:smith},
	we use Corollary~\ref{cor:presentation} to write $G$ as the cokernel
	of an $n\times m$ integer matrix $A$.  By Proposition~\ref{prop:smith}
	there are isomorphisms $Q:\Z^m\to \Z^m$ and $P:\Z^n\to \Z^n$ such that
	$A'=PAQ$ has diagonal entries $n_1, n_2,\ldots,
	n_s,0,\ldots,0$, where $n_1>1$ and $n_1\mid n_2 \mid{} \ldots \mid{}
	n_s$, and there are $r$ zeros.  Then $G$ is isomorphic to the cokernel of the diagonal matrix
	$A'$, so
	\begin{equation}\label{eqn:gprod}
		G \isom (\Z/n_1\Z) \oplus (\Z/n_2\Z)
		\oplus \cdots \oplus (\Z/n_s\Z) \oplus \Z^{r},
	\end{equation}
	as claimed.  The $n_i$ are determined by $G$, because $n_i$ is the
	smallest positive integer~$n$ such that $nG$ requires at most $s+r-i$
	generators. We see from the representation (\ref{eqn:gprod}) of $G$ as
	a product that $n_i$ has this property and that no smaller positive
	integer does.
\end{proof}

\begin{exercise}
	Recall Smith normal form defined in Proposition~\ref{prop:smith}. With only minor modifications, then the proposition and proof will work over any principle ideal domain. Find and apply these modifications then find the Smith normal form of the matrix $\begin{pmatrix} 1 & 2 & 3 \\ 0 & 1+i & 2 \\ 0 & 1 & 5 \end{pmatrix}$.
	
	\begin{hint}
		You can use \sage{} to verify your answer. However, you will need to explicitly construct the Gaussian integers in order to input the matrix. You can do this by the following code.
	\end{hint}
	\begin{sagecode}
	\begin{sagecell}
K.<i> = QuadraticField(-1)
R = K.maximal_order()
M = matrix(R, 3, [1,2,3,0,1+i,2,0,1,5]); show(M)
#show(M.smith_form()[0]) #uncomment for the answer
	\end{sagecell}
	\end{sagecode}
\end{exercise}

\begin{exercise}
	Let $A=\left(
	        \begin{matrix}1&2&3\\4&5&6\\7&8&9
	        \end{matrix}\right)$.
	\begin{enumerate}
	\item Find the Smith normal form of $A$.
	\item Prove that
	the cokernel of the map $\Z^3\to \Z^3$ given by multiplication by~$A$
	is isomorphic to $\Z/3\Z \oplus \Z$.
	\end{enumerate}
\end{exercise}

\section{Noetherian Rings and Modules}\label{sec:noetherian}

A module $M$ over a commutative ring $R$ with unit element is much
like a vector space, but with more subtle structure.  In this book,
most of the modules we encounter will be noetherian, which is a
generalization of the ``finite dimensional'' property of vector
spaces.  This section is about properties of noetherian modules (and
rings), which are crucial to much of this book.  We thus
give complete proofs of these properties, so you will have a solid
foundation on which to learn algebraic number theory.

We first define noetherian rings and modules, then introduce several
equivalent characterizations of them.  We prove that when the
base ring is noetherian, a module is finitely generated if and only if
it is noetherian.  Next we define short exact sequences, and prove
that the middle module in a sequence is noetherian if and only if the
first and last modules are noetherian.  Finally, we prove the Hilbert
basis theorem, which asserts that adjoining finitely many elements
to a noetherian ring results in a noetherian ring.

Let $R$ be a commutative ring with unity.
An \defn{$R$-module} is an additive abelian
group $M$ equipped with a map $R\times M \to M$ such that for all~$r,
r'\in R$ and all $m, m'\in M$ we have $(r r')m = r(r' m )$, $(r + r')m
= rm + r' m$, $r(m+m') = rm + rm'$, and $1m=m$.  A \defn{submodule} of $M$
is a subgroup of $M$ that is preserved by the action of $R$.
For example, $R$ is a module over itself, and
any ideal $I$ in $R$ is an $R$-submodule of $R$.

\begin{example}
	Abelian groups are the same as $\Z$-modules, and vector spaces
	over a field $K$ are the same as $K$-modules.
\end{example}

An $R$-module $M$ is finitely generated if there are elements $m_1, \ldots, m_n\in M$
such that every element of $M$ is an $R$-linear combination of the $m_i$.  The noetherian
property is stronger than just being finitely generated:

\begin{definition}[Noetherian]
	An $R$-module~$M$ is \defn{noetherian} if every
	submodule of $M$ is finitely generated.  A ring~$R$ is
	\defn{noetherian} if~$R$ is noetherian as a module over itself,
	i.e., if every ideal of~$R$ is finitely generated.
\end{definition}

Any submodule~$M'$ of a noetherian module~$M$ is also noetherian.
Indeed, if every submodule of~$M$ is finitely generated then so is
every submodule of $M'$, since submodules of $M'$ are also submodules
of $M$.

\begin{example}
	Let $R=M=\Q[x_1,x_2,\ldots]$ be a polynomial ring over $\Q$ in
	infinitely many indeterminants $x_i$.  Then $M$ is finitely generated
	{\em as an $R$-module} (!), since it is generated by $1$.  Consider
	the submodule $I=(x_1,x_2,\ldots)$ of polynomials with $0$ constant
	term, and suppose it is generated by polynomials $f_1, \ldots, f_n$.
	Let $x_i$ be an indeterminant that does not appear in any $f_j$, and
	suppose there are $h_k\in R$ such that $\sum_{k=1}^n h_k f_k = x_i$.
	Setting $x_i=1$ and all other $x_j=0$ on both sides of this equation
	and using that the $f_k$ all vanish (they have 0 constant term),
	yields $0=1$, a contradiction.  We conclude that the ideal $I$ is not
	finitely generated, hence $M$ is not a noetherian $R$-module, despite
	being finitely generated.
\end{example}

\begin{definition}[Ascending chain condition]
	An $R$-module $M$ satisfies the \defn{ascending chain condition} if
	every sequence $M_1\subset M_2 \subset M_3 \subset \cdots$ of
	submodules of~$M$ eventually stabilizes, i.e., there is some $n$ such
	that $M_n=M_{n+1}=M_{n+2}=\cdots$.
\end{definition}
We will use the notion of maximal element below.  If $\mathcal{X}$ is
a set of subsets of a set $S$, ordered by inclusion, then a
\defn{maximal element} $A\in \mathcal{X}$ is a set such that no superset
of $A$ is contained in $\mathcal{X}$.  Note that $\mathcal{X}$ may
contain many different maximal elements.

\begin{proposition}\iprop{characterization of noetherian}
	If $M$ is an $R$-module, then the following are equivalent:
	\begin{enumerate}
		\item $M$ is noetherian,
		\item $M$ satisfies the ascending chain condition, and
		\item Every nonempty set of submodules of $M$ contains at
		least one maximal element.
	\end{enumerate}
\end{proposition}
\begin{proof}
	\hfill
	\begin{description}
		\item[$(1\implies 2)$:]
			Suppose $M_1\subset M_2\subset \cdots$ is a
			sequence of submodules of $M$.  Then
			$M_\infty=\union_{n=1}^{\infty} M_n$ is a submodule of $M$.
			Since $M$ is noetherian and $M_\infty$ is a submodule of~$M$,
			there is a finite set $a_1,\ldots, a_m$ of 
			generators for $M_{\infty}$.  Each $a_i$
			must be contained in some $M_j$, so there is an $n$ such that
			$a_1,\ldots, a_m\in M_n$.  But then $M_{k}=M_n$ for all
			$k\geq n$, which proves that the chain of $M_i$ stabilizes,
			so the ascending chain condition holds for~$M$.
		
		\item[$(2\implies 3)$:]
			Suppose 3 were false, so there exists
			a nonempty set~$S$ of submodules of~$M$ that does not
			contain a maximal element.  We will use~$S$ to construct
			an infinite ascending chain of submodules of~$M$ that
			does not stabilize. Note that~$S$ is infinite, otherwise
			it would contain a maximal element.  Let $M_1$ be
			any element of~$S$.  Then there is an $M_2$ in $S$ that
			strictly contains $M_1$, otherwise $S$ would contain the maximal
			element $M_1$. Continuing inductively in this way we find
			an $M_3$ in $S$ that properly contains $M_2$, etc., and we
			produce an infinite ascending chain of submodules of $M$,
			which contradicts the ascending chain condition.
		
		\item[$(3\implies 1)$:]
			Suppose 1 is false, so there is a submodule $M'$ of~$M$ that
			is not finitely generated.  We will show that the set~$S$ of
			all finitely generated submodules of $M'$ does not
			have a maximal element, which will be a contradiction.
			Suppose~$S$ does have a maximal element~$L$.  Since~$L$
			is finitely generated and $L\subset M'$, and $M'$ is not
			finitely generated, there is an $a\in M'$ such that
			$a\not\in L$.  Then $L'=L+Ra$ is an element of~$S$ that
			strictly contains the presumed maximal element~$L$,
			a contradiction.
	\end{description}
\end{proof}

\begin{definition}
	A \defn{homomorphism} of $R$-modules $\vphi:M\to N$ is an abelian
	group homomorphism such that for any $r\in R$ and $m\in M$ we have
	$\vphi(rm) = r\vphi(m)$. A sequence
	$$
		L \xra{f} M \xra{g} N,
	$$
	where $f$ and $g$ are homomorphisms of $R$-modules, is \defn{exact}
	if $\im(f)=\ker(g)$. A \defn{short exact sequence} of $R$-modules
	is a sequence
	$$
		0 \to L \xra{f} M \xra{g} N \to 0
	$$
	that is exact at each point, i.e., $f$ is injective, $g$ is surjective,
	and $\im(f) = \ker(g)$.
\end{definition}

\begin{example}
	The sequence
	$$
		0 \to \Z \xra{2} \Z\ra \Z/2\Z \to 0
	$$
	is an exact sequence, where the first map sends $1$ to $2$,
	and the second is the natural quotient map.
\end{example}


\begin{lemma}\label{lem:noetherianexact}\ilem{exactness and noetherian}
	If
	$$
		0 \to L \xra{f} M \xra{g} N \to 0
	$$
	is a short exact sequence of~$R$-modules, then~$M$ is noetherian
	if and only if both~$L$ and~$N$ are noetherian.
\end{lemma}
\begin{proof}
	First suppose that~$M$ is noetherian.  Then~$L$ is a submodule
	of~$M$, so~$L$ is noetherian.  Let $N'$ be a submodule of~$N$;
	then the inverse image of $N'$ in~$M$ is a submodule of~$M$,
	so it is finitely generated, hence its image $N'$ is also finitely
	generated.  Thus~$N$ is noetherian as well.

	Next assume nothing about~$M$, but suppose that both~$L$ and~$N$ are
	noetherian.  Suppose $M'$ is a submodule of $M$; then $M_0=f(L)\cap M'$
	is isomorphic to a submodule of the noetherian module $L$, so $M_0$ is
	generated by finitely many elements $a_1,\ldots, a_n$.  The quotient
	$M'/M_0$ is isomorphic (via $g$) to a submodule of the noetherian
	module~$N$, so $M'/M_0$ is generated by finitely many elements
	$b_1,\ldots, b_m$. For each $i\leq m$, let $c_i$ be a lift of $b_i$ to
	$M'$, modulo $M_0$.  Then the elements $a_1,\ldots, a_n, c_1,\ldots,c_m$ 
	generate $M'$, for if $x\in M'$, then there is some element
	$y\in M_0$ such that $x-y$ is an $R$-linear combination of the $c_i$,
	and~$y$ is an $R$-linear combination of the $a_i$.
\end{proof}


\begin{proposition}
	\label{prop:noethfg}\iprop{noetherian equals finitely generated}
	Suppose~$R$ is a noetherian ring.  Then an $R$-module~$M$ is
	noetherian if and only if it is finitely generated.
\end{proposition}
\begin{proof}
	If~$M$ is noetherian then every submodule of~$M$ is finitely generated
	so~$M$ itself is finitely generated.  Conversely, suppose~$M$ is
	finitely generated, say by elements $a_1,\ldots, a_n$.  Then there is a
	surjective homomorphism from $R^n=R\oplus \cdots \oplus R$ to~$M$ that
	sends $(0,\ldots,0,1,0,\ldots,0)$ ($1$ in the $i$th factor) to $a_i$.
	Using Lemma~\ref{lem:noetherianexact} and exact sequences of
	$R$-modules such as $0\to R\to R\oplus R\to R\to 0$, we see
	inductively that $R^n$ is noetherian.  Again by
	Lemma~\ref{lem:noetherianexact}, homomorphic images of noetherian
	modules are noetherian, so~$M$ is noetherian.
\end{proof}

\begin{lemma}\label{lem:surjnoetherian}\ilem{surjection and noetherian}
	Suppose $\vphi:R\to S$ is a surjective homomorphism of
	rings and $R$ is noetherian. Then $S$ is noetherian.
\end{lemma}
\begin{proof}
	The kernel of $\vphi$ is an ideal $I$ in $R$, and
	we have an exact sequence
	$$
		0 \to I \to R \to S \to 0
	$$
	with~$R$ noetherian.
	This is an exact sequence of $R$-modules, where $S$ has the
	$R$-module structure induced from $\vphi$ (if $r\in R$
	and $s\in S$, then we define $rs = \vphi(r)s$).
	By Lemma~\ref{lem:noetherianexact}, it follows
	that~$S$ is a noetherian $R$-modules. Suppose~$J$ is an ideal of~$S$.
	Since~$J$ is an $R$-submodule of~$S$, if we view~$J$ as an $R$-module,
	then~$J$ is finitely generated. Since~$R$ acts on~$J$ through~$S$,
	the $R$-generators of~$J$ are also $S$-generators of~$J$, so~$J$
	is finitely generated as an ideal. Thus~$S$ is noetherian.
\end{proof}

\begin{theorem}[Hilbert Basis Theorem]
	\label{thm:hilbert}\ithm{Hilbert Basis}
	If $R$ is a noetherian ring and $S$ is finitely generated as a ring
	over~$R$, then~$S$ is noetherian.  In particular, for any~$n$ the
	polynomial ring $R[x_1,\ldots, x_n]$ and any of its quotients are
	noetherian.
\end{theorem}
\begin{proof}
Assume first that we have already shown that for any $n$ the
polynomial ring $R[x_1,\ldots, x_n]$ is noetherian.  Suppose $S$ is
finitely generated as a ring over $R$, so there are generators
$s_1,\ldots, s_n$ for $S$.  Then the map $x_i\mapsto s_i$ extends
uniquely to a surjective homomorphism $\pi: R[x_1,\ldots, x_n] \onto S$,
and Lemma~\ref{lem:surjnoetherian} implies that $S$ is noetherian.

The rings $R[x_1,\ldots, x_n]$ and $(R[x_1,\ldots,x_{n-1}])[x_n]$ are
isomorphic, so it suffices to prove that if~$R$ is noetherian then
$R[x]$ is also noetherian.  (Our proof follows
\cite[\S12.5]{artin:algebra}.)
Thus suppose $I$ is an ideal of $R[x]$ and that~$R$ is
noetherian.  We will show that $I$ is finitely generated.

Let $A$ be the set of leading coefficients of polynomials in $I$.
(The leading coefficient of a polynomial is the coefficient of
the highest degree monomial, or $0$ if the polynomial is $0$; thus
$3x^7 + 5x^2  - 4$ has leading coefficient $3$.)
We will first show that~$A$ is an ideal of~$R$.
Suppose $a,b\in A$ are nonzero with $a+b\neq 0$.  Then there are
polynomials~$f$ and~$g$ in~$I$ with leading coefficients~$a$ and~$b$.
If $\deg(f)\leq \deg(g)$, then $a+b$ is the leading coefficient of
$x^{\deg(g)-\deg(f)}f + g$, so $a+b\in A$; the argument when
$\deg(f)> \deg(g)$ is analogous.  Suppose $r\in R$ and $a\in A$
with $ra\neq 0$. Then $ra$ is the leading coefficient of $rf$, so
$ra\in A$.  Thus $A$ is an ideal in $R$.

Since $R$ is noetherian and $A$ is an ideal of $R$, there exist nonzero
$a_1,\ldots, a_n\in A$ that generate~$A$ as an ideal.  Since~$A$ is the set
of leading coefficients of elements of~$I$, and the $a_j$ are in~$A$,
we can choose for each $j\leq n$ an element $f_j\in I$ with leading
coefficient $a_j$.  By multiplying the $f_j$ by some power of~$x$, we
may assume that the $f_j$ all have the same degree $d\geq 1$.

Let $S_{<d}$ be the set of elements of~$I$ that have degree strictly
less than~$d$.  This set is closed under addition and under
multiplication by elements of~$R$, so $S_{<d}$ is a module over~$R$.
The module $S_{<d}$ is the submodule of the $R$-module of polynomials
of degree less than~$d$, which is noetherian by
Proposition~\ref{prop:noethfg} because it is generated by $1,x,\ldots,
x^{d-1}$.  Thus $S_{<d}$ is finitely generated, and we may choose
generators $h_1,\ldots, h_m$ for $S_{<d}$.

We finish by proving using induction on the degree that every $g\in I$ is an
$R[x]$-linear combination of $f_1,\ldots, f_n, h_1,\ldots, h_m$.
If $g\in I$ has degree $0$, then $g \in S_{<d}$, since $d\geq 1$, so
$g$ is a linear combination of $h_1,\ldots, h_m$.  Next suppose
$g\in I$ has degree $e$, and that we have proven the statement
for all elements of $I$ of degree $<e$.
If $e<d$, then $g\in S_{<d}$, so~$g$ is
in the $R[x]$-ideal generated by $h_1,\ldots, h_m$.  Next suppose
that $e\geq d$.  Then the leading coefficient~$b$
of~$g$ lies in the ideal~$A$ of leading coefficients of elements of~$I$, so there
exist $r_i\in R$ such that $b=r_1 a_1 + \cdots + r_n a_n$.  Since
$f_i$ has leading coefficient $a_i$, the difference $g- x^{e-d} (\sum_i r_i f_i)$ has degree less than the degree~$e$ of~$g$.  By induction $g-x^{e-d} (\sum_i r_i f_i)$ is an $R[x]$ linear combination of $f_1,\ldots, f_n,
h_1,\ldots, h_m$, so $g$ is also an $R[x]$ linear combination of
$f_1,\ldots, f_n, h_1,\ldots, h_m$.  Since each $f_i$ and $h_j$ lies in
$I$, it follows that $I$ is generated by $f_1,\ldots, f_n, h_1,\ldots,
h_m$, so $I$ is finitely generated, as required.
\end{proof}

\subsection{The Ring $\Z$ is Noetherian}\label{sec:Znoeth}

The ring $\Z$ is noetherian since every ideal of $\Z$ is
generated by one element.
\begin{proposition}\label{prop:zpid}\iprop{$\Z$ is a PID}
	Every ideal of the ring $\Z$ is principal.
\end{proposition}
\begin{proof}
	Suppose~$I$ is a nonzero ideal in~$\Z$. Let~$d$ be the least positive
	element of~$I$.  Suppose that $a\in I$ is any nonzero element of~$I$.
	Using the division algorithm, we write $a=dq + r$, where~$q$ is an
	integer and $0\leq r < d$.  We have $r=a-dq\in I$ and $r<d$, so our
	assumption that $d$ is minimal implies that $r=0$, hence $a=dq$ is in
	the ideal generated by~$d$. Thus~$I$ is the principal ideal generated
	by~$d$.
\end{proof}

\begin{example}
Let $I=(12,18)$ be the ideal of $\Z$ generated by $12$ and $18$.
If $n=12a+18b\in I$, with $a,b\in\Z$,
then $6\mid n$, since $6\mid 12$ and $6\mid 18$.
Also, $6=18-12\in I$, so $I=(6)$.

The ring $\Z$
in \sage{} is {\tt ZZ}, which is Noetherian.
\begin{sagecode}
\begin{sagecell}
ZZ.is_noetherian()
\end{sagecell}
\begin{sageout}
True
\end{sageout}
\end{sagecode}
We create the ideal $I$ in \sage{} as follows, and note that
it is principal:
\begin{sagecode}
\begin{sagecell}
I = ideal(12,18); I
\end{sagecell}
\begin{sageout}
Principal ideal (6) of Integer Ring
\end{sageout}
\begin{sagecell}
I.is_principal()
\end{sagecell}
\begin{sageout}
True
\end{sageout}
\end{sagecode}
We could also create $I$ as follows:
\begin{sagecode}
\begin{sagecell}
ZZ.ideal(12,18)
\end{sagecell}
\begin{sageout}
Principal ideal (6) of Integer Ring
\end{sageout}
\end{sagecode}
\end{example}

Propositions~\ref{prop:noethfg} and \ref{prop:zpid} together imply that
any finitely generated abelian group is noetherian.  This means that
subgroups of finitely generated abelian groups are finitely generated,
which provides the missing step in our proof of the structure theorem
for finitely generated abelian groups.

\begin{exercise}
	There is another way to show every principle ideal domain (for example $\Z$) is noetherian (contrast to the proof in Section~\ref{sec:Znoeth}). Let $R$ be a PID and $(a)$ an arbitrary ideal. Use the facts that $(b)\supseteq(a)$ if and only if $b \mid a$ and $R$ is a UFD to show that ascending chain of ideals starting with $(a)$ must stabilize.
\end{exercise}

\section{Rings of Algebraic Integers}

In this section we introduce the central objects of this book, which
are the rings of algebraic integers.  These are noetherian rings with
an enormous amount of structure.  We also introduce a function field
analogue of these rings.


An \defn{algebraic number} is a root of some nonzero polynomial $f(x) \in \Q[x]$.
For example, $\sqrt{2}$ and $\sqrt{5}$ are both algebraic numbers, being
roots of $x^2-2$ and $x^2-5$, respectively.
But is $\sqrt{2} + \sqrt{5}$ necessarily the root of some polynomial in $\Q[x]$?
This isn't quite so obvious.

\begin{proposition}\label{prop:fdalg}
	An element $\alpha$ of a field extension of $\Q$ is an
	algebraic number if and only if the ring $\Q[\alpha]$
	generated by $\alpha$ is finite dimensional as a $\Q$ vector
	space.
\end{proposition}
\begin{proof}
	Suppose $\alpha$ is an algebraic number, so there is a nonzero
	polynomial $f(x)\in\Q[x]$, so that $f(\alpha)=0$. The equation
	$f(\alpha)=0$ implies that $\alpha^{\deg(f)}$ can be written in
	terms of smaller powers of $\alpha$, so $\Q[\alpha]$ is spanned
	by the finitely many numbers $1,\alpha,\ldots,\alpha^{\deg(f)-1}$,
	hence finite dimensional. Conversely, suppose $\Q[\alpha]$ is finite
	dimensional.  Then for some $n\geq 1$, we have that $\alpha^n$ is in
	the $\Q$-vector space spanned by $1,\alpha,\ldots, \alpha^{n-1}$.
	Thus $\alpha$ satisfies a polynomial $f(x) \in \Q[x]$ of degree $n$.
\end{proof}

\begin{proposition}\label{prop:algnumfield}
	Suppose $K$ is a field and $\alpha, \beta\in K$ are two
	algebraic numbers. Then $\alpha\beta$ and $\alpha+\beta$
	are also algebraic numbers.
\end{proposition}
\begin{proof}
	Let $n = \dim_\Q \Q[\alpha]$ and $m = \dim_\Q \Q[\beta]$.
	The subring $\Q[\alpha,\beta]\subset K$ is a
	$\Q$-vector space that is spanned by the numbers $\alpha^i\beta^j$,
	where $0\leq i<n$ and $0\leq j<m$. Thus
	$\Q[\alpha,\beta]$ is finite dimensional, and since $\alpha+\beta$
	and $\alpha\beta$ are both in $\Q[\alpha,\beta]$, we conclude by Proposition~\ref{prop:fdalg} that both are algebraic numbers.
\end{proof}

Suppose $C$ is a field extension of $\Q$ such that every polynomial
$f(x)\in \Q[x]$ factors completely in $C$.
The algebraic closure $\Qbar$ of $\Q$ inside $C$
is the  field generated by all roots in $C$ of polynomials
in $\Q[x]$.
The fundamental theorem of algebra tells us that
$C=\C$ is one choice of field $C$ as above.
There are other fields $C$, e.g., constructed using $p$-adic numbers.
One can show that any two choices of~$\Qbar$ are isomorphic; however,
there will be {\em many} isomorphisms between them.

\begin{definition}[Algebraic Integer]
	An element $\alpha\in\Qbar$ is an \defn{algebraic integer} if it
	is a root of some monic polynomial with coefficients in~$\Z$.
\end{definition}
For example, $\sqrt{2}$ is an algebraic integer, since it is a root
of the monic integral polynomial $x^2-2$. As we will see below,
$1/2$ is not an algebraic integer.

The following two propositions are analogous to
Propositions~\ref{prop:fdalg}--\ref{prop:algnumfield} above, with
the proofs replacing basic facts about vector spaces with facts we
proved above about noetherian rings and modules.

\begin{proposition}
	\label{prop:intfg}\iprop{characterization of integrality}
	An element $\alpha\in\Qbar$ is an algebraic integer if and
	only if $\Z[\alpha]$ is finitely generated as a $\Z$-module.
\end{proposition}
\begin{proof}
	Suppose~$\alpha$ is integral and let $f\in\Z[x]$ be a monic
	integral polynomial such that $f(\alpha)=0$.  Then, as a
	$\Z$-module, $\Z[\alpha]$ is generated by 
	$1,\alpha,\alpha^2,\ldots,\alpha^{d-1}$, where~$d$ is
	the degree of~$f$. Conversely, suppose $\alpha\in\Qbar$ is such
	that $\Z[\alpha]$ is finitely generated as a module over $\Z$,
	say by elements $f_1(\alpha), \ldots, f_n(\alpha)$. Let~$d$ be
	any integer bigger than the degrees of all~$f_i$. Then there exist
	integers $a_i$ such that $\alpha^d = \sum_{i=1}^n a_i f_i(\alpha)$,
	hence~$\alpha$ satisfies the monic polynomial
	$x^d - \sum_{i=1}^n a_i f_i(x) \in \Z[x]$, so~$\alpha$
	is an algebraic integer.
\end{proof}

The proof of the following proposition uses repeatedly that any
submodule of a finitely generated $\Z$-module is finitely generated,
which uses that $\Z$ is noetherian and that finitely generated modules
over a noetherian ring are noetherian.
\begin{proposition}
	\iprop{$\Zbar$ is a ring}\label{prop:zbarring}
	Suppose $K$ is a field and $\alpha, \beta\in K$ are two algebraic
	integers. Then $\alpha\beta$ and $\alpha+\beta$ are also algebraic
	integers.
\end{proposition}
\begin{proof}
	Let $m, n$ be the degrees of monic integral polynomials that have
	$\alpha, \beta$ as roots, respectively.  Then we can write $\alpha^m$
	in terms of smaller powers of $\alpha$ and likewise for $\beta^n$, so
	the elements $\alpha^i\beta^j$ for $0\leq i < m$ and $0\leq j< n$ span
	the $\Z$-module $\Z[\alpha, \beta]$.  Since $\Z[\alpha + \beta]$ is a 
	submodule of the finitely-generated $\Z$-module $\Z[\alpha, \beta]$,
	it is finitely generated, so $\alpha+\beta$ is integral.
	Likewise, $\Z[\alpha\beta]$ is a submodule of $\Z[\alpha, \beta]$,
	so it is also finitely generated, and $\alpha\beta$ is integral.
\end{proof}



\subsection{Minimal Polynomials}

\begin{definition}[Minimal Polynomial]\label{defn:minpoly}
	The \defn{minimal polynomial} of $\alpha\in\Qbar$ is the
	monic polynomial $f\in\Q[x]$ of least positive degree such
	that $f(\alpha)=0$.
\end{definition}
It is a consequence of Lemma~\ref{lem:mindiv} below that
``the'' minimal polynomial of~$\alpha$ is unique.
The minimal polynomial of $1/2$ is $x-1/2$, and
the minimal polynomial of $\sqrt[3]{2}$ is $x^3-2$.

\begin{example}
We compute the minimal polynomial of a number expressed
in terms of $\sqrt[4]{2}$:
\begin{sagecode}
\begin{sagecell}
k.<a> = NumberField(x^4 - 2)
a^4
\end{sagecell}
\begin{sageout}
2
\end{sageout}
\begin{sagecell}
(a^2 + 3).minpoly()
\end{sagecell}
\begin{sageout}
x^2 - 6*x + 7
\end{sageout}
\end{sagecode}
\end{example}

\begin{exercise}
	Find the minimal polynomial of $\sqrt{2} + \sqrt{3}$ by hand.
	Check your result with \sage{}.
\end{exercise}

\begin{lemma}\label{lem:mindiv}
	Suppose $\alpha \in\Qbar$.  Then the minimal polynomial of~$\alpha$
	divides any polynomial~$h$ such that $h(\alpha)=0$.
\end{lemma}
\begin{proof}
	Let~$f$ be a choice of minimal polynomial of~$\alpha$, as in
	Definition~\ref{defn:minpoly}, and let $h$ be a polynomial with
	$h(\alpha)=0$.  Use the division algorithm to write $h=qf + r$,
	where $0\leq \deg(r) < \deg(f)$.  We have $$r(\alpha) = h(\alpha) -
	q(\alpha) f(\alpha) = 0,$$ so $\alpha$ is a root of~$r$.
	However,~$f$ is a polynomial of least positive degree with
	root~$\alpha$, so $r=0$.
\end{proof}

\begin{exercise}
	Show that the minimal polynomial of an algebraic number
	$\alpha\in\Qbar$ is unique.
\end{exercise}

\begin{lemma}
	\label{lem:minpolint}\ilem{minimal polynomial of algebraic integer}
	Suppose~$\alpha \in\Qbar$. Then $\alpha$ is an algebraic integer if
	and only if the minimal polynomial $f$ of~$\alpha$ has coefficients
	in~$\Z$.
\end{lemma}
\begin{proof}
	\hfill
	\begin{description}
		\item[$(\impliedby)$:]
			Since $f\in \Z[x]$ is monic (by definition) and $f(\alpha)=0$,
			we see immediately that $\alpha$ is an algebraic integer.
		\item[$(\implies)$:]
			Since $\alpha$ is an algebraic integer, there is
			some nonzero monic $g\in\Z[x]$ such that $g(\alpha)=0$.
			By Lemma~\ref{lem:mindiv}, we have $g=fh$, for some $h\in\Q[x]$,
			and $h$ is monic because $f$ and $g$ are.  If $f\not\in\Z[x]$,
			then some prime~$p$ divides the denominator of some coefficient
			of $f$.  Let $p^i$ be the largest power of~$p$ that divides some 
			denominator of some coefficient of~$f$, and likewise let $p^j$ be
			the largest power of~$p$ that divides some denominator of a 
			coefficient of~$h$.  Then $p^{i+j}g = (p^if)(p^j h)$, and if we 
			reduce both sides modulo $p$, then the left hand side is $0$ but 
			the right hand side is a product of two nonzero polynomials in 
			$\F_p[x]$, hence nonzero, a contradiction.
	\end{description}
\end{proof}

\begin{exercise}
	Which of the following numbers are algebraic integers?
	\begin{enumerate}[label=(\emph{\alph*})]
		\item The number $(1+\sqrt{5})/2$.
		\item The number $(2+\sqrt{5})/2$.
		\item The value of the infinite sum $\sum_{n=1}^{\infty} 1/n^2$.
		\item The number $\alpha/3$, where $\alpha$ is a root of
		$x^4 + 54x + 243$.
	\end{enumerate}
\end{exercise}

\begin{example}
We compute some minimal polynomials in \sage.
The minimal polynomial of $1/2$:
\begin{sagecode}
\begin{sagecell}
(1/2).minpoly()
\end{sagecell}
\begin{sageout}
x - 1/2
\end{sageout}
We construct a root $a$ of $x^2-2$ and compute its minimal polynomial:
\begin{sagecell}
k.<a> = NumberField(x^2 - 2)
a^2 - 2
\end{sagecell}
\begin{sageout}
0
\end{sageout}
\begin{sagecell}
a.minpoly()
\end{sagecell}
\begin{sageout}
x^2 - 2
\end{sageout}
\end{sagecode}
%link
Finally we compute the minimal polynomial of $\alpha=\sqrt{2}/2 + 3$, which
is not integral, hence Proposition~\ref{prop:intfg} implies that $\alpha$
is not an algebraic integer:
%link
\begin{sagecode}
\begin{sagecell}
(a/2 + 3).minpoly()
\end{sagecell}
\begin{sageout}
x^2 - 6*x + 17/2
\end{sageout}
\end{sagecode}
\end{example}

The only elements of $\Q$ that are algebraic integers are the usual
integers $\Z$, since $\Z[1/d]$ is not finitely generated as a $\Z$-module.
Watch out since there are elements of $\Qbar$ that seem to {\em appear}
to have denominators when written down, but are still algebraic integers.
This is an artifact of how we write them down, e.g., if we wrote
our integers as a multiple of $\alpha=2$, then we would write $1$
as $\alpha/2$. For example,
$$
	\alpha = \frac{1+\sqrt{5}}{2}
$$
is an algebraic integer, since it is a root of the monic integral
polynomial $x^2 - x - 1$.  We verify this using \sage below,
though of course this is easy to do by hand (you should try
much more complicated examples in \sage).
\begin{sagecode}
\begin{sagecell}
k.<a> = QuadraticField(5)
a^2
\end{sagecell}
\begin{sageout}
5
\end{sageout}
\begin{sagecell}
alpha = (1 + a)/2
alpha.minpoly()
\end{sagecell}
\begin{sageout}
x^2 - x - 1
\end{sageout}
\begin{sagecell}
alpha.is_integral()
\end{sagecell}
\begin{sageout}
True
\end{sageout}
\end{sagecode}

Since $\sqrt{5}$ can be expressed in terms of radicals, we can also
compute this minimal polynomial using the symbolic functionality in
Sage.
\begin{sagecode}
\begin{sagecell}
alpha = (1+sqrt(5))/2
alpha.minpoly()
\end{sagecell}
\begin{sageout}
x^2 - x - 1
\end{sageout}
Here is a more complicated example using a similar approach:
\begin{sagecell}
alpha = sqrt(2) + 3^(1/4)
alpha.minpoly()
\end{sagecell}
\begin{sageout}
x^8 - 8*x^6 + 18*x^4 - 104*x^2 + 1
\end{sageout}
\end{sagecode}

\begin{example}
	We illustrate an example of a sum and product of two algebraic
	integers being an algebraic integer. We first make the relative
	number field obtained by adjoining a root of $x^3 - 5$ to the
	field $\Q(\sqrt{2})$:
\begin{sagecode}
\begin{sagecell}
k.<a, b> = NumberField([x^2 - 2, x^3 - 5])
k
\end{sagecell}
\begin{sageout}
Number Field in a with defining polynomial x^2 + -2 over its base field
\end{sageout}
\end{sagecode}
%link
\noindent Here $a$ and $b$ are roots of $x^2-2$ and $x^3-5$, respectively.
%link
\begin{sagecode}
\begin{sagecell}
a^2
\end{sagecell}
\begin{sageout}
2
\end{sageout}
\begin{sagecell}
b^3
\end{sagecell}
\begin{sageout}
5
\end{sageout}
\end{sagecode}

\noindent We compute the minimal polynomial of the sum and product of
$\sqrt[3]{5}$ and $\sqrt{2}$.  The command {\tt absolute\_minpoly}
gives the minimal polynomial of the element over the rational numbers $\Q$.
%link
\begin{sagecode}
\begin{sagecell}
(a+b).absolute_minpoly()
\end{sagecell}
\begin{sageout}
x^6 - 6*x^4 - 10*x^3 + 12*x^2 - 60*x + 17
\end{sageout}
\begin{sagecell}
(a*b).absolute_minpoly()
\end{sagecell}
\begin{sageout}
x^6 - 200
\end{sageout}
\end{sagecode}
The minimal polynomial of the product $\sqrt[3]{5} \sqrt{2}$ is
trivial to compute by hand.  In light of the Cayley-Hamilton theorem,
we can compute the minimal polynomial of $\alpha = \sqrt[3]{5} +
\sqrt{2}$ by hand by computing the determinant of the matrix given by
left multiplication by $\alpha$ on the basis
$$
	1,\sqrt{2}, \sqrt[3]{5}, \sqrt[3]{5}\sqrt{2}, \sqrt[3]{5}^2, \sqrt[3]{5}^2\sqrt{2}.
$$
This is a general method which works well for computers. However it can
also be done using simple algebra.
\begin{exercise} % thanks to Silverman
	Compute the minimal polynomial of $\alpha = \sqrt[3]{5} + \sqrt{2}$
	by hand without finding the determinate of a $6\times 6$ matrix.

	\begin{hint}
		Let $a^2 = 2$, $b^3 = 5$, and $x = a+b$.
		Then $(x-a)^3 = b^3 = 5$. Now simplify and
		use the fact that $a^2 = 2$.
	\end{hint}
\end{exercise}

The following is an alternative, more symbolic way to compute the
minimal polynomials above, though it is not provably correct.  We
compute $\alpha$ to 100 bits precision (via the {\tt n} command), then
use the LLL algorithm (via the {\tt algdep} command) to heuristically
find a linear relation between the first $6$ powers of $\alpha$ (see
Section~\ref{sec:LLL} below for more about LLL).
\begin{sagecode}
\begin{sagecell}
a = 5^(1/3); b = sqrt(2)
c = a+b; c
\end{sagecell}
\begin{sageout}
5^(1/3) + sqrt(2)
\end{sageout}
\begin{sagecell}
(a+b).n(100).algdep(6)
\end{sagecell}
\begin{sageout}
x^6 - 6*x^4 - 10*x^3 + 12*x^2 - 60*x + 17
\end{sageout}
\begin{sagecell}
(a*b).n(100).algdep(6)
\end{sagecell}
\begin{sageout}
x^6 - 200
\end{sageout}
\end{sagecode}
\end{example}

\begin{exercise}
	Let $\alpha = \sqrt{2} + \frac{1+\sqrt{5}}{2}$.
	\begin{enumerate}[label=(\emph{\alph*})]
		\item Is $\alpha$ an algebraic integer?
		\item Explicitly write down the minimal polynomial
		of $\alpha$ as an element of $\Q[x]$.
	\end{enumerate}
\end{exercise}


\subsection{Number fields, rings of integers, and orders}

\begin{definition}[Number field]
	A \defn{number field} is a field~$K$ that contains the rational
	numbers $\Q$ such that the degree $[K:\Q] = \dim_\Q(K)$ is finite.
\end{definition}

If $K$ is a number field, then by the primitive element theorem there
is an $\alpha \in K$ so that $K = \Q(\alpha)$.  Let $f(x) \in \Q[x]$
be the minimal polynomial of $\alpha$.  Fix a choice of algebraic
closure $\Qbar$ of $\Q$.  Associated to each of the $\deg(f)$ roots
$\alpha'\in\Qbar$ of $f$, we obtain a field embedding $K\hra \Qbar$
that sends $\alpha$ to $\alpha'$.  Thus any number field can be
embedded in $[K:\Q]=\deg(f)$ distinct ways in $\Qbar$.

\begin{definition}[Ring of Integers]
	The \defn{ring of integers} of a number field~$K$ is the ring
	$$
		\O_K = \{x \in K : \text{ $x$ is an algebraic integer}\}.
	$$
\end{definition}

One of the most basic facts about $\O_K$ is that it is indeed a ring.
This fact is important enough to be stated as a separate theorem.

\begin{theorem}
	Let $K$ be a number field.
	The ring of integers $\O_K$ is a ring.
\end{theorem}
\begin{proof}
	This follows directly from Proposition~\ref{prop:zbarring}.
\end{proof}


\begin{example}
	The field $\Q$ of rational numbers is a number field of degree $1$,
	and the ring of integers of $\Q$ is $\Z$.  The field $K=\Q(i)$ of
	Gaussian integers has degree $2$ and $\O_K = \Z[i]$.
\end{example}

\begin{example}\label{example:Qsqrt5ringofints}
	The golden ratio $\varphi =(1+\sqrt{5})/2$ is in the quadratic
	number field $K=\Q(\sqrt{5})=\Q(\varphi)$; notice that
	$\varphi$ satisfies $x^2-x-1$, so $\varphi\in\O_K$.
	To see that $\O_K = \Z[\varphi]$ directly, we proceed as follows.
	By Proposition~\ref{prop:intfg}, the algebraic integers of $K$
	are exactly the elements $a+b\sqrt{5} \in K$, with $a,b\in\Q$
	that have integral minimal polynomial. The matrix of $a+b\sqrt{5}$
	with respect to the basis $1,\sqrt{5}$ for $K$ is
	$m=\abcd{a}{5b}{b}{a}$. The characteristic polynomial of $m$ is
	$f = (x-a)^2 - 5b^2 = x^2 - 2ax + a^2 - 5b^2$, which is in $\Z[x]$
	if and only if $2a\in\Z$ and $a^2-5b^2\in\Z$. Thus $a=a'/2$ with
	$a'\in\Z$, and $(a'/2)^2 - 5b^2 \in\Z$, so $5b^2 \in \frac{1}{4}\Z$,
	so $b\in\frac{1}{2}\Z$ as well. If $a$ has a denominator of $2$,
	then $b$ must also have a denominator of $2$ to ensure that the
	difference $a^2-5b^2$ is an integer. This proves that
	$\O_K = \Z[\varphi]$.
\end{example}

\begin{example}
	The ring of integers of $K=\Q(\sqrt[3]{9})$ is $\Z[\sqrt[3]{3}]$,
	where $\sqrt[3]{3}=\frac{1}{3}(\sqrt[3]{9})^2 \not \in \Z[\sqrt[3]{9}]$.
	As we will see, in general the problem of computing $\O_K$ given $K$
	may be very hard, since it requires factoring a certain potentially
	large integer.
\end{example}

\begin{exercise}
	From basic definitions, find the rings of integers of the fields
	$\Q(\sqrt{11})$ and $\Q(\sqrt{-6})$.
\end{exercise}

\begin{definition}[Order]\label{defn:order}
	An \defn{order} in $\O_K$ is any subring $R$ of $\O_K$ such that
	the quotient $\O_K/R$ of abelian groups is finite.
	(By definition $R$ must contain $1$ because it is a ring.)
\end{definition}
As noted above, $\Z[i]$ is the ring of integers of $\Q(i)$.  For every
nonzero integer~$n$, the subring $\Z+ni\Z$ of $\Z[i]$ is an order.
The subring $\Z$ of $\Z[i]$ is not an order, because $\Z$ does not
have finite index in $\Z[i]$.  Also the subgroup $2\Z + i\Z$ of
$\Z[i]$ is not an order because it is not a ring.

\begin{exercise}\label{ex:orderInQuadraticExts}
	Let $K$ be a quadratic extension of $\Q$
	and $R$ be any order in $\O_K$.
	Show that $\O_K/R$ is cyclic as an abelian group
	and that there is a bijection between orders of
	$\O_K$ containing $R$ and divisors of $[\O_K:R]$.
\end{exercise}

\begin{remark}
	Exercise~\ref{ex:orderInQuadraticExts} is used in
	elliptic curve cryptography to measure the number
	of isogenies; this is used in \cite[\S11.2]{Koblitz2011781}
	for an example.
\end{remark}

We define the number field $\Q(i)$ and compute its
ring of integers.
\begin{sagecode}
\begin{sagecell}
K.<i> = NumberField(x^2 + 1)
OK = K.ring_of_integers(); OK
\end{sagecell}
\begin{sageout}
Order with module basis 1, i in Number Field in i with
defining polynomial x^2 + 1
\end{sageout}
\end{sagecode}
%link

\noindent Next we compute the order $\Z + 3i \Z$.
%link
\begin{sagecode}
\begin{sagecell}
O3 = K.order(3*i); O3
\end{sagecell}
\begin{sageout}
Order with module basis 1, 3*i in Number Field in i with
defining polynomial x^2 + 1
\end{sageout}
\begin{sagecell}
O3.gens()
\end{sagecell}
\begin{sageout}
[1, 3*i]
\end{sageout}
\end{sagecode}
%link


\noindent We test whether certain elements are in the order.
%link
\begin{sagecode}
\begin{sagecell}
5 + 9*i in O3
\end{sagecell}
\begin{sageout}
True
\end{sageout}
\begin{sagecell}
1 + 2*i in O3
\end{sagecell}
\begin{sageout}
False
\end{sageout}
\end{sagecode}


We will frequently consider orders because they are often much easier
to write down explicitly than $\O_K$.  For example, if $K=\Q(\alpha)$
and $\alpha$ is an algebraic integer, then $\Z[\alpha]$ is an order in
$\O_K$, but frequently $\Z[\alpha]\neq \O_K$.

\begin{example}
In this example $[\O_K : \Z[a]] = 2197$.  First we define
the number field $K=\Q(a)$ where $a$ is a root of $x^3 - 15 x^2 - 94 x - 3674$,
then we compute the order $\Z[a]$ generated by $a$.
\begin{sagecode}
\begin{sagecell}
K.<a> = NumberField(x^3 - 15*x^2 - 94*x - 3674)
Oa = K.order(a); Oa
\end{sagecell}
\begin{sageout}
Order with module basis 1, a, a^2 in Number Field in a with defining
polynomial x^3 - 15*x^2 - 94*x - 3674
\end{sageout}
\begin{sagecell}
Oa.basis()
\end{sagecell}
\begin{sageout}
[1, a, a^2]
\end{sageout}
\end{sagecode}
%link

\noindent Next we compute a $\Z$-basis for the maximal order $\O_K$ of $K$, and
compute that the index of $\Z[a]$ in $\O_K$ is $2197=13^3$.
%link
\begin{sagecode}
\begin{sagecell}
OK = K.maximal_order()
OK.basis()
\end{sagecell}
\begin{sageout}
[25/169*a^2 + 10/169*a + 1/169, 5/13*a^2 + 1/13*a, a^2]
\end{sageout}
\begin{sagecell}
Oa.index_in(OK)
\end{sagecell}
\begin{sageout}
2197
\end{sageout}
\end{sagecode}
\end{example}

\begin{lemma}\label{lem:intq}\ilem{$\O_K$ span and $\O_K\cap \Q=\Z$}
	Let $\O_K$ be the ring of integers of a number field.
	Then $\O_K\cap \Q = \Z$ and $\Q\O_K = K$.
\end{lemma}
\begin{proof}
	Suppose $\alpha\in \O_K\cap\Q$ with $\alpha=a/b \in \Q$ in lowest
	terms and $b>0$.  Since $\alpha$ is integral, $\Z[a/b]$ is finitely
	generated as a module, so $b=1$.
	
	To prove that $\Q\O_K=K$, suppose $\alpha\in K$, and let
	$f(x)\in\Q[x]$ be the minimal monic polynomial of~$\alpha$.  For any
	positive integer~$d$, the minimal monic polynomial of $d\alpha$ is
	$d^{\deg(f)}f(x/d)$, i.e., the polynomial obtained from $f(x)$ by
	multiplying the coefficient of $x^{\deg(f)}$ by~$1$, multiplying the
	coefficient of $x^{\deg(f)-1}$ by~$d$, multiplying the coefficient of
	$x^{\deg(f)-2}$ by $d^2$, etc.  If~$d$ is the least common multiple of
	the denominators of the coefficients of~$f$, then the minimal monic
	polynomial of $d\alpha$ has integer coefficients, so $d\alpha$ is
	integral and $d\alpha\in \O_K$.  This proves that $\Q\O_K = K$.
\end{proof}

\begin{exercise}
	Which of the following rings are orders in the given
	number field, i.e. orders in the ring of integers of the
	given number field.
	\begin{enumerate}[label=(\emph{\alph*})]
		\item The ring $R = \Z[i]$ in the number field $\Q(i)$.
		\item The ring $R = \Z[i/2]$ in the number field $\Q(i)$.
		\item The ring $R = \Z[17i]$ in the number field $\Q(i)$.
		\item The ring $R = \Z[i]$ in the number field $\Q(\sqrt[4]{-1})$.
	\end{enumerate}
\end{exercise}

\subsection{Function fields}
Let $k$ be any field.  We can also make the same definitions, but with $\Q$
replaced by the field $k(t)$ of rational functions in an indeterminate
$t$, and $\Z$ replaced by $k[t]$.
The analogue of a number field is called a {\em function field}; it is
a finite algebraic extension field $K$ of $k(t)$.  Elements of $K$
have a unique minimal polynomial as above, and the ring of integers of
$K$ consists of those elements whose monic minimal polynomial has
coefficients in the polynomial ring $k[t]$.

Geometrically, if $F(x,t)=0$ is an affine equation that defines (via
projective closure) a nonsingular projective curve $C$, then
$K=k(t)[x]/(F(x,t))$ is a function field.  We view the field $K$ as
the field of all rational functions on the projective closure of the
curve $C$.  The ring of integers $\O_K$ is the subring of rational
functions that have no poles on the affine curve $F(x,t)=0$, though
they may have poles at infinity, i.e., at the extra points we
introduce when passing to the projective closure $C$.  The algebraic
arguments we gave above prove that $\O_K$ is a ring.  This is also
geometrically intuitive, since the sum and product of two functions
with no poles also have no poles.

\begin{exercise}
	Let $k = \F_p$ be the finite field with $p$ elements where $p$ is some prime. Find all automorphisms of $k(t)$. Note that an automorphism is completely characterized by its value on $t$. How many such automorphisms are there?

	\begin{hint}
		For some people, it is easier to think about the equivalent question: For what rational functions $f\in k(t)$ is the map $k(t)\to k(t)$ given by $t\mapsto f(t)$ an automorphism?
	\end{hint}
\end{exercise}

\section{Norms and Traces}

In this section we develop some basic properties of norms, traces, and
discriminants, and give more properties of rings of integers in the
general context of Dedekind domains.

Before discussing norms and traces we introduce some notation for
field extensions.  If $K\subset L$ are number fields, we let $[L:K]$
denote the dimension of~$L$ viewed as a $K$-vector space.  If~$K$ is a
number field and $a\in \Qbar$, let $K(a)$ be the extension of~$K$
generated by~$a$, which is the smallest number field that contains
both~$K$ and~$a$.  If $a\in\Qbar$ then~$a$ has a minimal polynomial
$f(x)\in\Q[x]$, and the \defn{Galois conjugates} of~$a$ are the roots
of~$f$. These are called the Galois conjugates because they are the orbit
of $a$ under the action of $\Gal(\Qbar/\Q)$.

\begin{example}
The element $\sqrt{2}$ has minimal polynomial $x^2-2$ and the Galois
conjugates of $\sqrt{2}$ are $\sqrt{2}$ and $-\sqrt{2}$.  The cube root $\sqrt[3]{2}$
has minimial polynomial $x^3 - 2$ and three Galois conjugates
$\sqrt[3]{2}, \zeta_3\sqrt[3]{2}, \zeta_3^2\sqrt[3]{2}$, where
$\zeta_3$ is a cube root of unity.

We create the extension $\Q(\zeta_3)(\sqrt[3]{2})$ in \sage.
\begin{sagecode}
\begin{sagecell}
L.<cuberoot2> = CyclotomicField(3).extension(x^3 - 2)
cuberoot2^3
\end{sagecell}
\begin{sageout}
2
\end{sageout}
\end{sagecode}
%link
\noindent Then we list the Galois conjugates of $\sqrt[3]{2}$.
%link
\begin{sagecode}
\begin{sagecell}
cuberoot2.galois_conjugates(L)
\end{sagecell}
\begin{sageout}
[cuberoot2, (-zeta3 - 1)*cuberoot2, zeta3*cuberoot2]
\end{sageout}
\end{sagecode}
%link
\noindent Note that $\zeta_3^2 = -\zeta_3 - 1$:
%link
\begin{sagecode}
\begin{sagecell}
zeta3 = L.base_field().0
zeta3^2
\end{sagecell}
\begin{sageout}
-zeta3 - 1
\end{sageout}
\end{sagecode}
\end{example}

Suppose $K\subset L$ is an inclusion of number fields and let $a\in
L$.  Then left multiplication by~$a$ defines a $K$-linear
transformation $\ell_a:L\to L$.  (The transformation $\ell_a$ is
$K$-linear because $L$ is commutative.)

\begin{definition}[Norm and Trace]\label{defn:normtrace}
	The \defn{norm} and \defn{trace} of~$a$ from~$L$ to~$K$ are
	$$
		\Norm_{L/K}(a)=\det(\ell_a)
		\quad\text{ and }\quad
		\tr_{L/K}(a)=\tr(\ell_a).
	$$
\end{definition}
We know from linear algebra that
determinants are multiplicative
and traces are additive, so for $a,b\in L$ we have
$$\Norm_{L/K}(ab) = \Norm_{L/K}(a)\cdot \Norm_{L/K}(b)$$
and
$$\tr_{L/K}(a+b) = \tr_{L/K}(a) + \tr_{L/K}(b).$$

Note that if $f\in\Q[x]$ is the characteristic polynomial of~$\ell_a$,
then the constant term of $f$ is $(-1)^{\deg(f)}\det(\ell_a)$, and the
coefficient of $x^{\deg(f)-1}$ is $-\tr(\ell_a)$.

\begin{proposition}\label{prop:normtracesigma}\iprop{norm and trace}
	Let $a\in L$ and let $\sigma_1,\ldots, \sigma_d$, where $d=[L:K]$, be
	the distinct field embeddings $L\hra \Qbar$ that fix every element
	of~$K$.  Then
	$$
		\Norm_{L/K}(a) = \prod_{i=1}^d \sigma_i(a)
		\quad\text{ and }\quad
		\tr_{L/K}(a) = \sum_{i=1}^d \sigma_i(a).
	$$
\end{proposition}
\begin{proof}
	We prove the proposition by computing the characteristic
	polynomial of~$a$.  Let $f\in K[x]$ be the minimal polynomial
	of~$a$ over~$K$, and note that~$f$ has distinct roots and is
	irreducible, since it is the polynomial in $K[x]$ of least degree
	that is satisfied by~$a$ and~$K$ has characteristic~$0$.  Since~$f$
	is irreducible, we have $K(a) \isom K[x]/(f)$, so $[K(a):K]=\deg(f)$.
	Also~$a$ satisfies a polynomial if and only if~$\ell_a$ does, so the
	characteristic polynomial of $\ell_a$ acting on $K(a)$ is~$f$.  Let
	$b_1,\ldots,b_n$ be a basis for $L$ over $K(a)$ and note that
	$1,\ldots, a^m$ is a basis for $K(a)/K$, where $m=\deg(f)-1$.  Then
	$a^i b_j$ is a basis for $L$ over $K$, and left multiplication by
	$a$ acts the same way on the span of $b_j, a b_j, \ldots, a^m b_j$
	as on the span of $b_k, a b_k, \ldots, a^m b_k$, for any pair $j,
	k\leq n$.  Thus the matrix of $\ell_a$ on $L$ is a block direct sum
	of copies of the matrix of $\ell_a$ acting on $K(a)$, so the
	characteristic polynomial of $\ell_a$ on~$L$ is $f^{[L:K(a)]}$.  The
	proposition follows because the roots of $f^{[L:K(a)]}$ are exactly
	the images $\sigma_i(a)$, with multiplicity $[L:K(a)]$, since each
	embedding of $K(a)$ into $\Qbar$ extends in exactly $[L:K(a)]$ ways
	to $L$.
\end{proof}

\begin{warning}
	It is important in Proposition~\ref{prop:normtracesigma} that
	the product and sum be over {\em all} the images $\sigma_i(a)$,
	not over just the distinct images.  For example, if $a=1\in L$, then
	$\Tr_{L/K}(a) = [L:K]$, whereas the sum of the distinct conjugates
	of $a$ is $1$.
\end{warning}

\begin{remark}
	Let $K\subset L$ be an extension of number fields.  If
	$\alpha\in \O_L$, then the formula of
	Proposition~\ref{prop:normtracesigma} implies that the norm and trace
	down to~$K$ of $\alpha$ is an element of~$\O_K$, because the sum and
	product of algebraic integers is an algebraic integer. In particular, if $\alpha \in \O_L$ and $K=\Q$, then the norm and trace of $\alpha$ is an integer. 
\end{remark}

The following corollary asserts that the norm and trace behave well in
towers.
\begin{corollary}
	\icor{norm, trace compatible with towers}\label{cor:compatower}
	Suppose $K\subset L \subset M$ is a tower of number fields, and
	let $a\in M$.  Then
	$$
		\Norm_{M/K}(a) = \Norm_{L/K}(\Norm_{M/L}(a))
		\quad\text{ and }\quad
		\tr_{M/K}(a) = \tr_{L/K}(\tr_{M/L}(a)).
	$$
\end{corollary}
\begin{proof}
	The proof uses that every embedding $L\hra \Qbar$ extends in exactly
	$[M:L]$ way to an embedding $M\hra \Qbar$.  This is clear
	if we view $M$ as $L[x]/(h(x))$ for some irreducible
	polynomial $h(x) \in L[x]$ of degree $[M:L]$, and note that
	the extensions of $L\hra \Qbar$ to $M$ correspond to
	the roots of $h$, of which there are $\deg(h)$, since $\Qbar$
	is algebraically closed.
	
	For the first equation, both sides are the product of $\sigma_i(a)$,
	where $\sigma_i$ runs through the embeddings of~$M$ into $\Qbar$
	that fix $K$. To see this, suppose $\sigma:L\to \Qbar$ fixes $K$ and
	$\tau_1,\ldots, \tau_d$ are the embeddings of $M$ into $\Qbar$ that
        fix $L$. Next, fix a normal extension $N$ of $\Q$ containing $M$
	(e.g., the normal closure of $M/K$), and let $\sigma'$ and
	(for each $1 \leq i \leq d$) $\tau_i^'$ be the extensions of,
	respectively, $\sigma$ and $\tau_i$  to automorphisms of $N$.
	Then the compositions $\sigma' \tau_1^{'},\ldots,\sigma'\tau_d^{'}$,
	when restricted to $M$, are exactly the extensions of~$\sigma$ to~$M$.
	For the second statement, both sides are the sum of the $\sigma_i(a)$.
\end{proof}

\begin{proposition}\label{prop:ok_lattice}\iprop{$\O_K$ is a lattice}
	Let~$K$ be a number field.  The ring of integers $\O_K$ is a
	lattice in~$K$, i.e., $\Q\O_K=K$ and $\O_K$ is an abelian group
	of rank $[K:\Q]$.
\end{proposition}
\begin{proof}
	We saw in Lemma~\ref{lem:intq} that $\Q\O_K=K$.  Thus there exists a
	basis $a_1,\ldots, a_n$ for~$K$, where each~$a_i$ is in $\O_K$.
	Suppose that as $x=\sum_{i=1}^n c_i a_i\in \O_K$ varies over all
	elements of $\O_K$ the denominators of the coefficients $c_i$ are not
	all uniformly bounded.  Then subtracting off integer multiples of the
	$a_i$, we see that as $x=\sum_{i=1}^n c_i a_i\in \O_K$ varies over
	elements of $\O_K$ with $c_i$ between $0$ and $1$, the denominators of
	the $c_i$ are also arbitrarily large.  This implies that there are
	infinitely many elements of $\O_K$ in the bounded subset
	$$
		S = \left\{
			c_1 a_1 +\cdots + c_n a_n : c_i \in \Q,\, 0\leq c_i \leq 1
		\right\} \subset K.
	$$
	Thus for any $\eps>0$, there are elements $a,b\in \O_K$ such that the
	coefficients of $a-b$ are all less than $\eps$ (otherwise the elements
	of $\O_K$ would all be a ``distance''
	of least~$\eps$ from each other, so only finitely
	many of them would fit in~$S$).
	
	As mentioned above, the norms of elements of $\O_K$ are integers.
	Since the norm of an element is the determinant of left multiplication
	by that element, the norm is a homogeneous polynomial of degree $n$ in
	the indeterminate coefficients $c_i$, which is $0$ only on the
	element~$0$, so the constant term of this polynomial is $0$.
	If the $c_i$ get arbitrarily small for elements of
	$\O_K$, then the values of the norm polynomial get arbitrarily small,
	which would imply that there are elements of $\O_K$ with positive norm
	too small to be in $\Z$, a contradiction.  So the set $S$ contains
	only finitely many elements of $\O_K$.  Thus the denominators of the
	$c_i$ are bounded, so for some $d$, we have that $\O_K$ has finite
	index in $A=\frac{1}{d}\Z a_1 + \cdots + \frac{1}{d}\Z a_n$.  Since
	$A$ is isomorphic to $\Z^n$, it follows from the structure theorem for
	finitely generated abelian groups that $\O_K$ is isomorphic as a
	$\Z$-module to $\Z^n$, as claimed.
\end{proof}

\begin{corollary}\label{prop:intnoetherian}\icor{$\O_K$ is noetherian}
	The ring of integers $\O_K$ of a number field is noetherian.
\end{corollary}
\begin{proof}
	By Proposition~\ref{prop:ok_lattice}, the ring $\O_K$ is
	finitely generated as a module over $\Z$, so it is certainly
	finitely generated as a ring over $\Z$.
	By Theorem~\ref{thm:hilbert}, $\O_K$ is noetherian.
\end{proof}


\section{Recognizing Algebraic Numbers using LLL}\label{sec:LLL}

Suppose we somehow compute a decimal approximation $\alpha$
to some rational number $\beta \in \Q$ and from this wish
to recover $\beta$.  For concreteness, say
$$
	\beta = \frac{22}{389} = 
	0.05655526992287917737789203
	084832904884318766066838046
	\ldots
$$
and we compute
$$
	\alpha = 0.056555.
$$
Now suppose given only $\alpha$ that you would like to recover
$\beta$.  A standard technique is to use continued fractions, which
yields a sequence of good rational approximations
for $\alpha$; by truncating right before a surprisingly big
partial quotient (the $23$ in the continued fraction {\tt v}),
we obtain $\beta$:
\begin{sagecode}
\begin{sagecell}
v = continued_fraction(0.056555); v
\end{sagecell}
\begin{sageout}
[0, 17, 1, 2, 6, 1, 23, 1, 1, 1, 1, 1, 2]
\end{sageout}
\begin{sagecell}
convergents([0, 17, 1, 2, 6, 1])
\end{sagecell}
\begin{sageout}
[0, 1/17, 1/18, 3/53, 19/336, 22/389]
\end{sageout}
\end{sagecode}

Generalizing this, suppose next that somehow you numerically approximate
an algebraic number, e.g., by evaluating a special
function and get a decimal approximation $\alpha \in \C$
to an algebraic number $\beta \in \Qbar$.  For concreteness,
suppose $\beta = \frac{1}{3} + \sqrt[4]{3}$:
\begin{sagecode}
\begin{sagecell}
N(1/3 + 3^(1/4), digits=50)
\end{sagecell}
\begin{sageout}
1.64940734628582579415255223513033238849340192353916
\end{sageout}
\end{sagecode}
Now suppose you very much want to find the (rescaled)
minimal polynomial $f(x) \in \Z[x]$
of $\beta$ just given this numerical approximation $\alpha$.
This is of great value even without proof, since often in practice
once you know a potential minimal polynomial you can
verify that it is in fact right.  Exactly this situation
arises in the explicit construction of class fields (a
more advanced topic in number theory) and in the construction
of Heegner points on elliptic curves.   As we will see, the
LLL algorithm provides a polynomial time way to solve this
problem, assuming $\alpha$ has been computed to
sufficient precision.

\subsection{LLL Reduced Basis}
Given a basis $b_1,\ldots, b_n$ for $\R^n$, the \defn{Gramm-Schmidt
orthogonalization} process produces an orthogonal basis
$b_1^*,\ldots, b_n^*$ for $\R^n$ as follows.  Define inductively
$$
	b_i^* = b_i - \sum_{j < i} \mu_{i,j} b_j^*
$$
where
$$
	\mu_{i,j} = \frac{b_i \cdot b_j^*}{b_j^* \cdot b_j^*}.
$$

\begin{example}
We compute the Gramm-Schmidt orthogonal basis of the rows
of a matrix.  Note that no square roots are introduced
in the process; there would be square roots if we
constructed an orthonormal basis.
\begin{sagecode}
\begin{sagecell}
A = matrix(ZZ, 2, [1,2, 3,4]); A
\end{sagecell}
\begin{sageout}
[1 2]
[3 4]
\end{sageout}
\begin{sagecell}
Bstar, mu = A.gramm_schmidt()
\end{sagecell}
\end{sagecode}
%link

\noindent{}The rows of the matrix $B^*$ are obtained
from the rows of $A$ by the Gramm-Schmidt procedure.
%link
\begin{sagecode}
\begin{sagecell}
Bstar
\end{sagecell}
\begin{sageout}
[   1    2]
[ 4/5 -2/5]
\end{sageout}
\begin{sagecell}
mu
\end{sagecell}
\begin{sageout}
[   0    0]
[11/5    0]
\end{sageout}
\end{sagecode}
\end{example}

A \defn{lattice} $L\subset \R^n$ is a subgroup that
is free of rank $n$ such that $\R L = \R^n$.

\begin{definition}[LLL-reduced basis]
The basis $b_1,\ldots, b_n$ for a lattice $L\subset \R^n$
is \defn{LLL reduced} if for all $i,j$,
$$
	 |\mu_{i,j}| \leq \frac{1}{2}
$$
and for each $i\geq 2$,
$$
	|b_i^*|^2 \geq \left( \frac{3}{4} - \mu_{i,i-1}^2\right) | b_{i-1}^*|^2
$$

\end{definition}

For example, the basis $b_1 = (1,2)$, $b_2 = (3,4)$ for a lattice $L$
 is {\em not}
LLL reduced because $b_1^*=b_1$ and
$$
	\mu_{2,1} = \frac{b_2 \cdot b_1^*}{b_1^* \cdot b_1^*}
	= \frac{11}{5} > \frac{1}{2}.
$$
However, the basis $b_1 = (1,0)$, $b_2 = (0,2)$ for $L$ is
LLL reduced, since
$$
	\mu_{2,1} = \frac{b_2 \cdot b_1^*}{b_1^* \cdot b_1^*}
	= 0,
$$
and
$$
	2^2 \geq (3/4) \cdot 1^2.
$$
\begin{sagecode}
\begin{sagecell}
A = matrix(ZZ, 2, [1,2, 3,4])
A.LLL()
\end{sagecell}
\begin{sageout}
[1 0]
[0 2]
\end{sageout}
\end{sagecode}

\subsection{What LLL really means}
The following theorem is not too difficult to prove.

Let $b_1, \ldots, b_n$ be an LLL reduced basis
for a lattice $L\subset \R^n$.  Let $d(L)$ denote
the absolute value of the determinant of any matrix
whose rows are basis for $L$.   Then the vectors
$b_i$ are ``nearly orthogonal'' and ``short'' in
the sense of the following theorem:
\begin{theorem}
	We have
	\begin{enumerate}
		\item
			$d(L) \leq \prod_{i=1}^n |b_i| \leq 2^{n(n-1)/4} d(L)$.
		\item
			For $1\leq j \leq i \leq n$, we have
			$$
				|b_j| \leq 2^{(i-1)/2} |b_i^*|.
			$$
		\item
			The vector $b_1$ is very short in the sense that
			$$
				|b_1| \leq 2^{(n-1)/4} d(L)^{1/n}
			$$
			and for every nonzero $x \in L$ we have
			$$
				|b_1| \leq 2^{(n-1)/2} |x|.
			$$
		\item
			More generally, for any linearly independent
			$x_1,\ldots, x_t \in L$, we have
			$$
				|b_j| \leq 2^{(n-1)/2} \max(|x_1|, \ldots, |x_t|)
			$$
			for $1\leq j \leq t$.
	\end{enumerate}
\end{theorem}

Perhaps the most amazing thing about the idea of an LLL
reduced basis is that there is an algorithm (in fact many)
that given a basis for a lattice $L$ produce an LLL reduced
basis for $L$, and do so {\em quickly}, i.e., in polynomial
time in the number of digits of the input.   The current
optimal implementation (and practically optimal algorithms)
for computing LLL reduced basis are due to Damien Stehle,
and are included standard in Magma in Sage.   Stehle's code
is amazing -- it can LLL reduce a random lattice in $\R^{n}$
for $n<1000$ in a matter of minutes!
\begin{sagecode}
\begin{sagecell}
A = random_matrix(ZZ, 200)
t = cputime()
B = A.LLL()
cputime(t)     # random output
\end{sagecell}
\begin{sageout}
3.0494159999999999
\end{sageout}
\end{sagecode}
%link

\noindent{}There is even a very fast variant of Stehle's implementation that computes a basis for $L$ that is very likely LLL reduced but may in rare
cases fail to be LLL reduced.

%link
\begin{sagecode}
\begin{sagecell}
t = cputime()
B = A.LLL(algorithm="fpLLL:fast")   # not tested
cputime(t)      # random output
\end{sagecell}
\begin{sageout}
0.96842699999999837
\end{sageout}
\end{sagecode}

\subsection{Applying LLL}

The LLL definition and algorithm has many application in
number theory, e.g., to cracking lattice-based cryptosystems,
to enumerating all short vectors in a lattice, to finding relations
between decimal approximations to complex numbers, to very
fast univariate polynomial factorization in $\Z[x]$ and more
generally in $K[x]$ where $K$ is a number field, and to
computation of kernels and images of integer matrices.  LLL
can also be used to solve the problem of recognizing algebraic
numbers mentioned at the beginning of Section~\ref{sec:LLL}.

Suppose as above that $\alpha$ is a decimal approximation
to some algebraic number $\beta$, and for simplicity
assume that $\alpha\in\R$ (the general case of $\alpha \in \C$
is described in \cite{cohen:course_ant}).
We finish by explaining how to use LLL to find a polynomial
$f(x) \in \Z[x]$ such that $f(\alpha)$ and its coefficients
are small, hence has a shot at being the minimal polynomial
of $\beta$.

Given a real number decimal approximation $\alpha$, an
integer $d$ (the degree), and an integer $K$ (a function
of the precision to which $\alpha$ is known), the following
steps produce a polynomial $f(x) \in \Z[x]$ of degree
at most $d$ such that $f(\alpha)$ is small.
\begin{enumerate}
	\item Form the lattice in $\R^{d+2}$ with basis the rows
	of the matrix $A$ whose first $(d+1) \times (d+1)$ part is the
	identity matrix, and whose last column has entries
	\begin{equation}\label{eqn:K}
		K, \lfloor K\alpha \rfloor, \lfloor K\alpha^2 \rfloor,
		\ldots, \lfloor K\alpha^{d} \rfloor.
	\end{equation}
	(Note this matrix is $(d+1) \times (d+2)$ so the lattice
	is not of full rank in $\R^{d+2}$, which isn't a problem,
	since the LLL definition also makes sense for fewer vectors.)

	\item Compute an LLL reduced basis for the $\Z$-span of the rows
	of $A$, and let $B$ be the corresponding matrix.
	Let $b_1 = (a_0, a_1, \ldots, a_{d+1})$ be the first
	row of $B$ and notice that $B$ is obtained from $A$
	by left multiplication by an invertible integer matrix.
	Thus $a_0,\ldots, a_d$ are the linear combination of the
	(\ref{eqn:K}) that equals $a_{d+1}$. Moreover, since $B$
	is LLL reduced we expect that $a_{d+1}$ is relatively small.

	\item Output $f(x) = a_0 + a_1 x + \cdots + a_{d} x^d$.
	We have that $f(\alpha) \sim a_{d+1}/K$, which is small.
	Thus $f(x)$ may be a very good candidate for the minimal
	polynomial of $\beta$ (the algebraic number we are approximating),
	assuming $d$ was chosen minimally and $\alpha$ was computed
	to sufficient precision.
\end{enumerate}

The following is a complete implementation of the above algorithm
in Sage:
\begin{sagecode}
\begin{sagecell}
def myalgdep(a, d, K=10^6):
    aa = [floor(K*a^i) for i in range(d+1)]
    A = identity_matrix(ZZ, d+1)
    B = matrix(ZZ, d+1, 1, aa)
    A = A.augment(B)
    L = A.LLL()
    v = L[0][:-1].list()
    return ZZ['x'](v)
\end{sagecell}
\end{sagecode}
%link

Here is an example of using it:
%link
\begin{sagecode}
\begin{sagecell}
R.<x> = RDF[]
f = 2*x^3 - 3*x^2 + 10*x - 4
a = f.roots()[0][0]; a
myalgdep(a, 3, 10^6)       # not tested
\end{sagecell}
\begin{sageout}
2*x^3 - 3*x^2 + 10*x - 4
\end{sageout}
\end{sagecode}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "ant"
%%% End:
